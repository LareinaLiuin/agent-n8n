# n8n智能助手产品需求文档 (PRD)

## 1. 项目概述

### 1.1 产品名称
n8n智能助手 (n8n Agent Assistant)

### 1.2 产品定位
一个专门为n8n工作流自动化平台设计的AI智能助手，通过对话式交互帮助用户快速学习和掌握n8n平台的使用。

### 1.3 项目背景
用户在学习n8n平台时面临以下核心痛点：
- 缺乏完整的工作流理解和指导
- 对n8n各种节点的功能和使用方法不熟悉
- 在编写JavaScript代码节点时需要辅助和验证

## 2. 用户分析

### 2.1 目标用户群体
- **主要用户**：n8n平台初学者和中级用户
- **次要用户**：寻求n8n高级功能指导的专业用户
- **潜在用户**：考虑采用工作流自动化的开发者和业务分析师

### 2.2 用户需求
1. **SOP创建指导**：通过对话创建标准操作流程
2. **n8n节点推荐**：根据需求推荐合适的n8n节点和配置
3. **代码生成辅助**：为n8n代码节点生成JavaScript代码

## 3. 产品功能

### 3.1 核心功能

#### 3.1.1 对话式SOP创建
- **功能描述**：用户通过自然语言描述工作需求，AI助手通过多轮对话帮助用户创建完整的SOP
- **交互方式**：聊天式对话，AI主动提问澄清需求
- **输出内容**：结构化的标准操作流程文档

#### 3.1.2 n8n工作流指导
- **节点推荐**：根据用户需求推荐最合适的n8n节点
- **配置指导**：提供节点的具体配置参数和连接方式
- **最佳实践**：分享工作流设计的最佳实践和注意事项

#### 3.1.3 JavaScript代码生成
- **代码节点支持**：为n8n Function和Function Item节点生成JavaScript代码
- **上下文理解**：理解工作流上下文，生成适配的代码
- **代码验证**：提供基本的代码语法检查和优化建议

### 3.2 技术功能

#### 3.2.1 多会话管理
- **会话创建**：用户可以创建多个独立的对话会话
- **会话历史**：保存和查看历史对话记录
- **会话恢复**：可以继续之前的对话

#### 3.2.2 实时AI响应
- **快速响应**：使用优化的API调用确保快速响应
- **错误处理**：优雅处理API调用失败和服务异常
- **重试机制**：自动重试失败的API请求

## 4. 技术架构

### 4.1 前端技术栈
- **框架**：React 18 + TypeScript
- **构建工具**：Vite
- **样式**：Pure CSS（避免CSS框架兼容性问题）
- **组件**：模块化组件设计

### 4.2 后端技术栈
- **运行时**：Node.js + Express
- **语言**：TypeScript
- **AI集成**：OpenAI API（通过自定义代理服务）
- **数据存储**：内存存储（会话管理）

### 4.3 第三方服务集成

#### 4.3.1 AI服务
- **服务商**：wenwen-ai.com（breakout.wenwen-ai.com）
- **API类型**：OpenAI兼容API
- **配置信息**：
  - API Key: `sk-oF66pWBXKL4m3Ua7iJ1tERJy8PIURqiS2WFkJiXFvUCT7YxF`
  - Base URL: `https://breakout.wenwen-ai.com/v1`

#### 4.3.2 开发环境
- **前端端口**：5175
- **后端端口**：3001
- **CORS配置**：支持开发环境跨域访问

## 5. API接口设计

### 5.1 聊天相关接口

#### 5.1.1 创建会话
- **接口**：`POST /api/chat/session`
- **请求体**：`{ "title": "会话标题" }`
- **响应**：`{ "success": true, "data": { "sessionId": "xxx" } }`

#### 5.1.2 发送消息
- **接口**：`POST /api/chat/message`
- **请求体**：`{ "sessionId": "xxx", "message": "用户消息" }`
- **响应**：`{ "success": true, "data": { "message": { "role": "assistant", "content": "AI回复" } } }`

#### 5.1.3 获取会话历史
- **接口**：`GET /api/chat/session/:sessionId`
- **响应**：`{ "success": true, "data": { "session": { "messages": [] } } }`

### 5.2 SOP相关接口

#### 5.2.1 生成SOP
- **接口**：`POST /api/sop/generate`
- **请求体**：`{ "userInput": "用户描述的流程需求" }`
- **响应**：`{ "success": true, "data": { "sopSuggestion": "SOP建议内容" } }`

### 5.3 代码生成接口

#### 5.3.1 生成JavaScript代码
- **接口**：`POST /api/code/generate`
- **请求体**：`{ "requirement": "代码需求", "context": "上下文信息" }`
- **响应**：`{ "success": true, "data": { "code": "生成的JavaScript代码", "explanation": "代码说明" } }`

### 5.4 系统接口

#### 5.4.1 健康检查
- **接口**：`GET /health`
- **响应**：`{ "status": "ok", "openai": { "configured": true, "baseURL": "xxx" } }`

## 6. 用户体验设计

### 6.1 界面设计原则
- **简洁明了**：专注对话体验，减少视觉干扰
- **响应式设计**：支持桌面和移动端访问
- **实时反馈**：显示消息发送状态和AI思考过程

### 6.2 交互流程

#### 6.2.1 用户首次使用
1. 访问应用，看到简洁的聊天界面
2. 输入第一个关于n8n的问题或需求
3. AI助手回应并开始指导对话

#### 6.2.2 创建SOP流程
1. 用户描述业务流程需求
2. AI通过提问澄清具体需求
3. 生成结构化的SOP文档

#### 6.2.3 获取工作流帮助
1. 用户描述需要实现的功能
2. AI推荐合适的n8n节点
3. 提供具体的配置指导

### 6.3 错误处理
- **网络错误**：友好提示用户检查网络连接
- **API限制**：提示用户API使用限额和重置时间
- **服务异常**：提供备选解决方案或建议重试

## 7. 当前实现状态

### 7.1 已完成功能
- ✅ 基础前后端架构搭建
- ✅ OpenAI服务集成和配置
- ✅ 聊天会话管理功能
- ✅ SOP生成接口实现
- ✅ JavaScript代码生成接口
- ✅ 基础UI界面开发
- ✅ CORS配置和前后端通信

### 7.2 需要优化的功能
- 🔧 AI服务稳定性（API限制处理）
- 🔧 错误处理和用户反馈机制
- 🔧 会话持久化存储
- 🔧 界面美化和用户体验优化

### 7.3 待开发功能
- 📋 n8n节点知识库集成
- 📋 工作流模板库
- 📋 用户账户系统
- 📋 历史记录搜索功能
- 📋 导出功能（PDF、Markdown等）

## 8. 风险分析

### 8.1 技术风险
- **API稳定性**：依赖第三方AI服务，可能遇到服务不稳定
- **API限制**：当前API有使用上限，需要考虑多服务商支持
- **性能优化**：随着用户增长，需要优化响应速度

### 8.2 解决方案
- **多服务商支持**：集成多个AI服务提供商作为备选
- **缓存机制**：实现智能缓存减少API调用
- **负载均衡**：考虑服务端负载优化

## 9. 后续发展规划

### 9.1 短期目标（1-2个月）
- 完善基础功能稳定性
- 优化用户界面体验
- 增加更多n8n特定功能

### 9.2 中期目标（3-6个月）
- 支持更多自动化平台（如Make.com、Zapier）
- 增加协作功能
- 开发移动端应用

### 9.3 长期目标（6个月以上）
- 构建工作流模板市场
- 企业级功能支持
- 社区生态建设

## 10. 成功指标

### 10.1 技术指标
- API响应时间 < 3秒
- 系统可用性 > 99%
- 错误率 < 1%

### 10.2 用户指标
- 日活跃用户数
- 用户留存率
- 平均对话轮次
- 功能使用分布

---

**文档版本**：1.0
**创建日期**：2025年11月7日
**最后更新**：2025年11月7日
**负责人**：开发团队